# Grafana OAuth2/OIDC Configuration for RS256 Implementation
# Add this to your Grafana configuration (grafana.ini)

[auth.generic_oauth]
enabled = true
name = Admin Service
client_id = grafana-client
client_secret = grafana-secret

# OIDC Discovery (Grafana will auto-discover endpoints from this URL)
auth_url = http://localhost:3001/.well-known/openid-configuration

# Or manually specify endpoints:
# auth_url = http://localhost:3001/api/v1/oauth2/authorize
# token_url = http://localhost:3001/api/v1/oauth2/token
# api_url = http://localhost:3001/api/v1/oauth2/userinfo

# JWT Token Verification (This is the key benefit of RS256!)
# Grafana can verify JWT tokens using your public key from JWKS
use_pkce = false
use_refresh_token = true

# User attribute mapping from ID token
login_attribute_path = preferred_username
name_attribute_path = name  
email_attribute_path = email
groups_attribute_path = roles

# Role mapping based on roles claim in JWT
role_attribute_path = contains(roles[*], 'admin') && 'Admin' || 'Viewer'

# Allow sign up
allow_sign_up = true
auto_login = false

# Scopes to request
scopes = openid profile email

# Additional OAuth2 settings
allow_assign_grafana_admin = true
skip_org_role_sync = false